<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>System Snapshot Analyzer</title>
    <style>
        /* å…¨å±€æ ·å¼é‡ç½®ä¸åŸºç¡€é…ç½® - æå‡å¯è¯»æ€§ï¼Œæ·»åŠ æ³¨é‡Š */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, Segoe UI, Arial, sans-serif;
            background: #0f1115;
            color: #e6e6e6;
            line-height: 1.6;
            /* ä¼˜åŒ–è¡Œé«˜ï¼Œæå‡æ–‡å­—å¯è¯»æ€§ */
        }

        /* å¤´éƒ¨æ ·å¼ - ä¼˜åŒ–å¸ƒå±€ï¼Œæå‡è§†è§‰å±‚æ¬¡æ„Ÿ */
        header {
            padding: 12px 16px;
            background: #1a1d24;
            display: flex;
            gap: 12px;
            align-items: center;
            border-bottom: 1px solid #2a2f40;
            /* å¢åŠ åº•éƒ¨è¾¹æ¡†ï¼ŒåŒºåˆ†å¤´éƒ¨ä¸å†…å®¹ */
        }

        input[type="file"] {
            background: #222633;
            color: #fff;
            border: 1px solid #333;
            padding: 6px;
            border-radius: 8px;
            /* ç»Ÿä¸€åœ†è§’é£æ ¼ */
            cursor: pointer;
        }

        #status {
            color: #7fb3ff;
            /* çŠ¶æ€æ–‡å­—é«˜äº®ï¼Œæ›´é†’ç›® */
            font-size: 14px;
        }

        /* ä¸»å®¹å™¨å¸ƒå±€ - ä¼˜åŒ–é«˜åº¦è®¡ç®—ï¼Œé¿å…æ»šåŠ¨æº¢å‡ºé—®é¢˜ */
        #container {
            display: grid;
            grid-template-columns: 220px 1fr;
            height: calc(100vh - 57px);
            /* é€‚é…å¤´éƒ¨è¾¹æ¡†é«˜åº¦ï¼Œé¿å…æ»šåŠ¨æ¡ */
        }

        /* ä¾§è¾¹æ  - ä¼˜åŒ–æ»šåŠ¨æ ·å¼ï¼Œå¢åŠ è§†è§‰å±‚æ¬¡ */
        #sidebar {
            background: #161922;
            padding: 12px;
            overflow: auto;
            border-right: 1px solid #2a2f40;
            /* å¢åŠ å³ä¾§è¾¹æ¡†ï¼ŒåŒºåˆ†ä¾§è¾¹æ ä¸å†…å®¹åŒº */
        }

        /* å†…å®¹åŒº - ä¼˜åŒ–å†…è¾¹è·ï¼Œæå‡é˜…è¯»ä½“éªŒ */
        #content {
            padding: 20px;
            overflow: auto;
        }

        /* é€šç”¨æ¨¡å—æ ·å¼ */
        .section {
            margin-bottom: 28px;
            /* å¢åŠ æ¨¡å—é—´è·ï¼Œæå‡å±‚æ¬¡æ„Ÿ */
        }

        .card {
            background: #1c202b;
            border-radius: 12px;
            padding: 16px;
            /* å¢åŠ å†…è¾¹è·ï¼Œä¼˜åŒ–å†…å®¹å±•ç¤º */
            margin: 12px 0;
            /* ä¼˜åŒ–å¡ç‰‡é—´è· */
            box-shadow: 0 4px 12px rgba(0, 0, 0, .4);
            /* å¢å¼ºé˜´å½±ï¼Œæå‡ç«‹ä½“æ„Ÿ */
            border: 1px solid #2a2f40;
            /* å¢åŠ å¡ç‰‡è¾¹æ¡†ï¼Œæå‡ç²¾è‡´åº¦ */
            overflow: hidden;
            /* å…³é”®ï¼šé˜²æ­¢å¡ç‰‡å†…éƒ¨å†…å®¹æº¢å‡ºå¡ç‰‡è¾¹ç•Œ */
        }

        /* ç½‘æ ¼å¸ƒå±€ - ä¼˜åŒ–é—´è·ï¼Œæå‡å“åº”å¼è¡¨ç° */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            /* åŠ å®½å¡ç‰‡æœ€å°å®½åº¦ï¼Œæå‡å¯è¯»æ€§ */
            gap: 16px;
            /* å¢åŠ ç½‘æ ¼é—´è· */
        }

        small {
            color: #aaa;
            font-size: 13px;
        }

        /* æŒ‰é’®æ ·å¼ - ä¼˜åŒ–äº¤äº’æ•ˆæœï¼Œæå‡è§†è§‰åé¦ˆ */
        button {
            width: 100%;
            margin: 6px 0;
            /* ä¼˜åŒ–æŒ‰é’®é—´è· */
            background: #2a2f40;
            color: #fff;
            border: none;
            padding: 10px 8px;
            /* ä¼˜åŒ–æŒ‰é’®å†…è¾¹è· */
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease;
            /* å¢åŠ è¿‡æ¸¡åŠ¨ç”»ï¼Œæå‡äº¤äº’æ„Ÿ */
        }

        button:hover {
            background: #3a4060;
            transform: translateY(-1px);
            /* è½»å¾®ä¸Šæµ®ï¼Œå¢å¼ºæ‚¬æµ®åé¦ˆ */
        }

        /* è®¡æ•°ä¿¡æ¯ - é«˜äº®å±•ç¤ºï¼Œæå‡é†’ç›®åº¦ */
        .count {
            font-size: 14px;
            color: #7fb3ff;
            background: rgba(127, 179, 255, 0.1);
            /* å¢åŠ èƒŒæ™¯è‰²ï¼Œçªå‡ºè®¡æ•° */
            padding: 8px 12px;
            border-radius: 8px;
            display: inline-block;
            margin: 8px 0 16px 0;
            /* ä¼˜åŒ–é—´è· */
        }

        /* æ ¸å¿ƒç»Ÿè®¡æ±‡æ€» - ç‰¹æ®Šæ ·å¼ï¼Œçªå‡ºå…³é”®æ•°æ® */
        .summary-count {
            font-size: 15px;
            color: #a8d8ff;
            background: rgba(168, 216, 255, 0.08);
            padding: 12px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 3px solid #7fb3ff;
            /* å·¦ä¾§é«˜äº®è¾¹æ¡†ï¼Œçªå‡ºæ±‡æ€» */
        }

        /* å †æ ˆä¿¡æ¯ - ä¼˜åŒ–æ ·å¼ï¼Œæå‡å¯è¯»æ€§ */
        .stack {
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            /* é€‚å½“åŠ é«˜ï¼Œå±•ç¤ºæ›´å¤šå †æ ˆä¿¡æ¯ */
            overflow: auto;
            background: #12141a;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            white-space: pre-wrap;
            /* è‡ªåŠ¨æ¢è¡Œï¼Œé¿å…æ¨ªå‘æº¢å‡º */
            word-break: break-all;
            /* è¶…é•¿å†…å®¹æ¢è¡Œ */
        }

        /* çº¿ç¨‹çŠ¶æ€ - ä¸åŒçŠ¶æ€ä¸åŒé¢œè‰²ï¼Œæå‡è¾¨è¯†åº¦ */
        .thread-state {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .state-runnable {
            background: rgba(72, 187, 120, 0.2);
            color: #48bb78;
        }

        .state-waiting {
            background: rgba(192, 132, 252, 0.2);
            color: #c084fc;
        }

        .state-blocked {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .state-terminated {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .mixin-target-list {
            margin-top: 10px;
            padding: 8px;
            background: #12141a;
            border-radius: 8px;
            font-size: 13px;
            max-height: 160px;
            overflow-y: auto;

            /* å…³é”®ï¼šæ­£å¸¸æµå¸ƒå±€ */
            white-space: normal;
            word-break: break-word;
        }

        .mixin-item {
            padding: 3px 0;
            border-bottom: 1px solid #222633;
            line-height: 1.4;
        }

        .mixin-item:last-child {
            border-bottom: none;
        }

        /* Meta ä¿¡æ¯å†…éƒ¨é¡¹æ ·å¼ - è§„æ•´æ’ç‰ˆ */
        .meta-item {
            padding: 8px 0;
            border-bottom: 1px solid #222633;
            margin-bottom: 8px;
        }

        .meta-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ - æå‡æ·±è‰²ä¸»é¢˜è§†è§‰ä½“éªŒ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #161922;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #2a2f40;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #3a4060;
        }

        /* å“åº”å¼é€‚é… - æ‰‹æœºç«¯ä¼˜åŒ–å¸ƒå±€ */
        @media (max-width: 768px) {
            #container {
                grid-template-columns: 1fr;
                /* ç§»åŠ¨ç«¯å•åˆ—å¸ƒå±€ */
            }

            .grid {
                grid-template-columns: 1fr;
                /* ç§»åŠ¨ç«¯å¡ç‰‡å•åˆ—å±•ç¤º */
            }
        }
    </style>
</head>

<body>
    <!-- å¤´éƒ¨ï¼šæ–‡ä»¶ä¸Šä¼  + çŠ¶æ€æç¤º -->
    <header>
        <input type="file" id="fileInput" accept=".json"> <!-- å¢åŠ JSONæ–‡ä»¶ç­›é€‰ -->
        <span id="status">No file loaded</span>
    </header>

    <!-- ä¸»å®¹å™¨ï¼šä¾§è¾¹æ å¯¼èˆª + å†…å®¹å±•ç¤ºåŒº -->
    <div id="container">
        <div id="sidebar"></div>
        <div id="content"></div>
    </div>

    <script>
        // å…¨å±€å˜é‡ï¼šå­˜å‚¨å¿«ç…§æ•°æ®
        let snapshot = null;
        const sidebar = document.getElementById('sidebar');
        const content = document.getElementById('content');
        const fileInput = document.getElementById('fileInput');
        const status = document.getElementById('status');

        /**
         * æ–‡ä»¶ä¸Šä¼ å˜æ›´äº‹ä»¶ï¼šè¯»å–JSONæ–‡ä»¶å¹¶è§£æå¿«ç…§æ•°æ®
         */
        fileInput.onchange = e => {
            const file = e.target.files[0];
            if (!file) return;

            // éªŒè¯æ–‡ä»¶æ ¼å¼ä¸ºJSON
            if (!file.name.endsWith('.json')) {
                status.textContent = 'Error: Please upload a JSON file';
                status.style.color = '#ef4444';
                return;
            }

            const reader = new FileReader();
            reader.onload = () => {
                try {
                    snapshot = JSON.parse(reader.result);
                    buildSidebarMenu(); // æ„å»ºä¾§è¾¹æ èœå•
                    showMetaInfo(); // é»˜è®¤å±•ç¤ºå…ƒä¿¡æ¯
                    status.textContent = `Loaded: ${file.name}`;
                    status.style.color = '#7fb3ff';
                } catch (error) {
                    status.textContent = 'Error: Invalid JSON file';
                    status.style.color = '#ef4444';
                    console.error('JSONè§£æå¤±è´¥ï¼š', error);
                }
            };
            reader.readAsText(file);
        };

        /**
         * æ„å»ºä¾§è¾¹æ å¯¼èˆªèœå•
         */
        function buildSidebarMenu() {
            sidebar.innerHTML = '';
            addSidebarButton('Meta Info', showMetaInfo); // å…ƒä¿¡æ¯

            const groups = snapshot.groups || {};
            for (const key in groups) {
                if (key === 'mixins') {
                    addSidebarButton('Mixins (è¯¦ç»†ç»Ÿè®¡)', () => showMixinsDetail(groups.mixins));
                } else if (key === 'threads') {
                    addSidebarButton('Threads (å¸¦çŠ¶æ€)', () => showThreadsDetail(groups.threads));
                } else if (key === 'hardware') { // è¯†åˆ« hardware åˆ†ç»„
                    addSidebarButton('Hardware (ç¡¬ä»¶ä¿¡æ¯)', () => showHardwareDetail(groups.hardware));
                } else {
                    addSidebarButton(key, () => showGenericInfo(key, groups[key]));
                }
            }
        }

        /**
         * æ·»åŠ ä¾§è¾¹æ æŒ‰é’®
         * @param {string} btnName æŒ‰é’®åç§°
         * @param {Function} clickFn ç‚¹å‡»äº‹ä»¶å›è°ƒ
         */
        function addSidebarButton(btnName, clickFn) {
            const button = document.createElement('button');
            button.textContent = btnName;
            button.onclick = clickFn;
            sidebar.appendChild(button);
        }

        /**
         * ä¼˜åŒ– Meta ä¿¡æ¯å±•ç¤ºï¼ˆå‘Šåˆ«é›¶æ•£ï¼Œæ•´åˆä¸ºç²¾ç¾å¡ç‰‡ï¼‰- å…³é”®ä¿®æ”¹
         */
        function showMetaInfo() {
            const meta = snapshot.meta || {};
            // æ ¼å¼åŒ–æ—¶é—´æˆ³
            const snapshotTime = meta.timestamp
                ? new Date(meta.timestamp).toLocaleString()
                : 'Unknown';

            // æ•´åˆä¸ºå•ä¸ªå¡ç‰‡ï¼Œå†…éƒ¨è§„æ•´æ’ç‰ˆ
            content.innerHTML = `
                <div class='section'>
                    <h2>Meta Information <small>ï¼ˆå¿«ç…§å…ƒæ•°æ®ï¼‰</small></h2>
                    <div class='card'>
                        <h3 style="color: #7fb3ff; margin-bottom: 16px; font-size: 18px;">ğŸ“‹ å¿«ç…§æ ¸å¿ƒä¿¡æ¯</h3>
                        <div class='meta-item'>
                            <b>Minecraft ç‰ˆæœ¬</b>: ${meta.minecraftVersion || 'Unknown'}
                        </div>
                        <div class='meta-item'>
                            <b>Mod ç‰ˆæœ¬</b>: ${meta.modVersion || 'Unknown'}
                        </div>
                        <div class='meta-item'>
                            <b>Java ç‰ˆæœ¬</b>: ${meta.javaVersion || 'Unknown'}
                        </div>
                        <div class='meta-item'>
                            <b>å¿«ç…§ç”Ÿæˆæ—¶é—´</b>: ${snapshotTime}
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * å±•ç¤ºMixinsè¯¦ç»†ä¿¡æ¯ï¼ˆè¡¥å……å®Œæ•´è®¡æ•°ï¼Œè§£å†³é•¿åç§°æº¢å‡ºï¼‰
         * @param {object} mixinsData Mixinså¿«ç…§æ•°æ®
         */
        function showMixinsDetail(mixinsData) {

            const configs = mixinsData.configs ?? [];
            const targetSummary = mixinsData.targetSummary ?? {};

            const targetEntries = Object.entries(targetSummary);

            let totalRelations = 0;
            for (const [, list] of targetEntries) {
                totalRelations += list.length;
            }

            targetEntries.sort((a, b) => b[1].length - a[1].length);

            content.innerHTML = `
    <h2>Mixins Overview</h2>

    <div style="margin:12px 0;">
        <input 
            id="mixinSearch"
            placeholder="ğŸ” æœç´¢ Mixin å / åŒ…è·¯å¾„ / ç›®æ ‡ç±»..."
            style="
                width:100%;
                padding:10px;
                border-radius:8px;
                border:1px solid #2a2f40;
                background:#12141a;
                color:#fff;
                outline:none;
                font-size:14px;
            "
        >
    </div>

    <div class="summary-count">
        ğŸ“Š é…ç½®æ•°: ${configs.length}
        ï½œç›®æ ‡ç±»: ${targetEntries.length}
        ï½œæ³¨å…¥å…³ç³»: ${totalRelations}
    </div>

    <h3>ğŸ”¥ æ³¨å…¥çƒ­ç‚¹ç±»</h3>

    <div id="hotTargetList" class="card mixin-target-list"></div>

    <h3 style="margin-top:22px;">ğŸ“¦ Mixin é…ç½®</h3>

    <div id="mixinConfigGrid" class="grid"></div>
`;

            const hotTargetList = document.getElementById("hotTargetList");
            const mixinConfigGrid = document.getElementById("mixinConfigGrid");
            const searchInput = document.getElementById("mixinSearch");

            // ===== æ¸²æŸ“å‡½æ•° =====

            function renderHotTargets(filter = "") {
                const f = filter.toLowerCase();

                hotTargetList.innerHTML = targetEntries
                    .filter(([target]) => target.toLowerCase().includes(f))
                    .map(([target, list]) => `
            <div class="mixin-item">
                ${highlight(target, f)}
                <small>ï¼ˆ${list.length} æ¬¡æ³¨å…¥ï¼‰</small>
            </div>
        `).join('');
            }

            function renderConfigs(filter = "") {
                const f = filter.toLowerCase();

                mixinConfigGrid.innerHTML = configs
                    .filter(cfg => {
                        if (cfg.name?.toLowerCase().includes(f)) return true;
                        if (cfg.mixinPackage?.toLowerCase().includes(f)) return true;

                        return cfg.targets.some(t => t.toLowerCase().includes(f));
                    })
                    .map(cfg => `
            <div class="card">
                <b>åç§°</b>: ${highlight(cfg.name, f)}<br>
                <b>ä¼˜å…ˆçº§</b>: ${cfg.priority}<br>
                <b>åŒ…è·¯å¾„</b>: ${highlight(cfg.mixinPackage, f)}<br>
                <b>ç¯å¢ƒ</b>: ${cfg.environmentVersion}<br>
                <b>ç›®æ ‡æ•°é‡</b>: ${cfg.targets.length}

                <div style="margin-top:8px;">
                    <small>ç›®æ ‡ç±»ï¼š</small>
                    <div class="mixin-target-list">
                        ${cfg.targets
                            .filter(t => !f || t.toLowerCase().includes(f))
                            .map(t => `
                                <div class="mixin-item">
                                    ${highlight(t, f)}
                                </div>
                            `).join('')}
                    </div>
                </div>
            </div>
        `).join('');
            }

            // ===== é«˜äº®åŒ¹é… =====

            function highlight(text, keyword) {
                if (!keyword || !text) return text;

                const reg = new RegExp(`(${keyword})`, 'ig');
                return text.replace(reg, `<span style="color:#7fb3ff;font-weight:600;">$1</span>`);
            }

            // ===== åˆå§‹åŒ–æ¸²æŸ“ =====

            renderHotTargets();
            renderConfigs();

            // ===== å®æ—¶æœç´¢ =====

            searchInput.addEventListener("input", () => {
                const value = searchInput.value.trim();
                renderHotTargets(value);
                renderConfigs(value);
            });
        }


        /**
         * å±•ç¤ºçº¿ç¨‹è¯¦ç»†ä¿¡æ¯ï¼ˆå¸¦çŠ¶æ€é«˜äº®ã€å®Œæ•´å †æ ˆï¼‰
         * @param {object} threadsData çº¿ç¨‹å¿«ç…§æ•°æ®
         */
        function showThreadsDetail(threadsData) {
            const threadList = threadsData.threads || [];
            const totalThreads = threadList.length;
            const runnableThreads = threadList.filter(t => t.state === 'RUNNABLE').length;
            const waitingThreads = threadList.filter(t => t.state === 'WAITING').length;

            // æ„å»ºå†…å®¹HTML
            content.innerHTML = `
                <h2>Threads <small>(${totalThreads} ä¸ªçº¿ç¨‹)</small></h2>
                
                <!-- çº¿ç¨‹æ ¸å¿ƒç»Ÿè®¡ -->
                <div class='summary-count'>
                    ğŸ“Š çº¿ç¨‹ç»Ÿè®¡ï¼šå¯è¿è¡Œ = ${runnableThreads} | ç­‰å¾…ä¸­ = ${waitingThreads} | æ€»æ•° = ${totalThreads}
                </div>

                <!-- çº¿ç¨‹å¡ç‰‡ç½‘æ ¼ -->
                <div class='grid'>
                    ${threadList.map(thread => {
                // çº¿ç¨‹çŠ¶æ€æ ·å¼ç±»
                let stateClass = '';
                switch (thread.state) {
                    case 'RUNNABLE':
                        stateClass = 'state-runnable';
                        break;
                    case 'WAITING':
                        stateClass = 'state-waiting';
                        break;
                    case 'BLOCKED':
                        stateClass = 'state-blocked';
                        break;
                    case 'TERMINATED':
                        stateClass = 'state-terminated';
                        break;
                    default:
                        stateClass = '';
                }

                // æ„å»ºå †æ ˆä¿¡æ¯
                const stackHtml = thread.stack?.map(stack =>
                    `${stack.clazz}.${stack.method}(${stack.file}:${stack.line}) ${stack.module || ''}`
                ).join('\n') || 'æš‚æ— å †æ ˆä¿¡æ¯';

                return `
                            <div class='card'>
                                <b>çº¿ç¨‹åç§°</b>: ${thread.name || 'Unknown'}<br>
                                <b>çº¿ç¨‹ID</b>: ${thread.id || 'Unknown'}<br>
                                <b>çº¿ç¨‹çŠ¶æ€</b>: <span class='thread-state ${stateClass}'>${thread.state || 'Unknown'}</span><br>
                                <b>çº¿ç¨‹ç»„</b>: ${thread.group || 'Unknown'}<br>
                                <div class='stack'>${stackHtml}</div>
                            </div>
                        `;
            }).join('')}
                </div>
            `;
        }

        /**
         * å±•ç¤ºç¡¬ä»¶ä¿¡æ¯å¡ç‰‡ï¼ˆCPU/å†…å­˜/ç£ç›˜/æ“ä½œç³»ç»Ÿï¼‰
         * @param {object} hardwareData ç¡¬ä»¶å¿«ç…§æ•°æ®
         */
        function showHardwareDetail(hardwareData) {
            // è§£æ„ç¡¬ä»¶æ•°æ®ï¼Œæä¾›é»˜è®¤å€¼é¿å…æŠ¥é”™
            const cpu = hardwareData.cpu || {};
            const memory = hardwareData.memory || {};
            const disks = hardwareData.disks || [];
            const os = hardwareData.os || {};

            // æ•°æ®æ ¼å¼åŒ–ï¼šå­—èŠ‚è½¬GBï¼ˆä¿ç•™2ä½å°æ•°ï¼Œæ›´æ˜“è¯»ï¼‰
            const formatBytesToGB = (bytes) => {
                if (!bytes) return '0.00 GB';
                return (bytes / (1024 * 1024 * 1024)).toFixed(2) + ' GB';
            };

            // è®¡ç®—å†…å­˜ä½¿ç”¨ç‡
            const memoryUsedPercent = memory.totalBytes && memory.availableBytes
                ? (((memory.totalBytes - memory.availableBytes) / memory.totalBytes) * 100).toFixed(2)
                : '0.00';

            // æ„å»ºç¡¬ä»¶å¡ç‰‡HTML
            content.innerHTML = `
                <h2>Hardware Information <small>ï¼ˆç³»ç»Ÿç¡¬ä»¶å¿«ç…§ï¼‰</small></h2>
                
                <!-- ç¡¬ä»¶ä¿¡æ¯ç½‘æ ¼å¡ç‰‡ -->
                <div class='grid'>
                    <!-- CPU å¡ç‰‡ -->
                    <div class='card'>
                        <h3 style="color: #7fb3ff; margin-bottom: 12px;">ğŸ–¥ï¸ å¤„ç†å™¨ä¿¡æ¯</h3>
                        <div><b>å¤„ç†å™¨åç§°</b>: ${cpu.name || 'Unknown'}</div>
                        <div><b>æ ¸å¿ƒæ•°</b>: ${cpu.cores || 'Unknown'}</div>
                        <div><b>CPU ä½¿ç”¨ç‡</b>: <span style="color: #48bb78;">${cpu.loadPercent ? cpu.loadPercent.toFixed(2) + '%' : '0.00%'}</span></div>
                    </div>

                    <!-- å†…å­˜ å¡ç‰‡ -->
                    <div class='card'>
                        <h3 style="color: #7fb3ff; margin-bottom: 12px;">ğŸ§  å†…å­˜ä¿¡æ¯</h3>
                        <div><b>æ€»å†…å­˜</b>: ${formatBytesToGB(memory.totalBytes)}</div>
                        <div><b>å¯ç”¨å†…å­˜</b>: ${formatBytesToGB(memory.availableBytes)}</div>
                        <div><b>å†…å­˜ä½¿ç”¨ç‡</b>: <span style="color: #48bb78;">${memoryUsedPercent}%</span></div>
                    </div>

                    <!-- æ“ä½œç³»ç»Ÿ å¡ç‰‡ -->
                    <div class='card'>
                        <h3 style="color: #7fb3ff; margin-bottom: 12px;">ğŸ’» æ“ä½œç³»ç»Ÿ</h3>
                        <div><b>ç³»ç»Ÿåç§°</b>: ${os.name || 'Unknown'}</div>
                        <div><b>ç³»ç»Ÿç‰ˆæœ¬</b>: ${os.version || 'Unknown'}</div>
                        <div><b>ç³»ç»Ÿæ¶æ„</b>: ${os.arch || 'Unknown'}</div>
                    </div>

                    <!-- ç£ç›˜ å¡ç‰‡ï¼ˆæ”¯æŒå¤šä¸ªç£ç›˜ï¼Œå¾ªç¯æ¸²æŸ“ï¼‰ -->
                    ${disks.map((disk, index) => `
                        <div class='card'>
                            <h3 style="color: #7fb3ff; margin-bottom: 12px;">ğŸ’¾ ç£ç›˜ ${index + 1}</h3>
                            <div><b>ç£ç›˜å‹å·</b>: ${disk.model || 'Unknown'}</div>
                            <div><b>ç£ç›˜å¤§å°</b>: ${formatBytesToGB(disk.sizeBytes)}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        /**
         * å±•ç¤ºé€šç”¨åˆ†ç»„ä¿¡æ¯ï¼ˆJSONæ ¼å¼åŒ–å±•ç¤ºï¼‰
         * @param {string} groupName åˆ†ç»„åç§°
         * @param {object} groupData åˆ†ç»„æ•°æ®
         */
        function showGenericInfo(groupName, groupData) {
            content.innerHTML = `
                <h2>${groupName}</h2>
                <pre class='card'>${JSON.stringify(groupData, null, 2)}</pre>
            `;
        }

        // æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½ä¼˜åŒ–
        document.body.ondragover = e => { e.preventDefault(); };
        document.body.ondrop = e => {
            e.preventDefault();
            const file = e.dataTransfer.files[0];
            if (!file) return;

            // éªŒè¯JSONæ ¼å¼
            if (!file.name.endsWith('.json')) {
                status.textContent = 'Error: Please upload a JSON file';
                status.style.color = '#ef4444';
                return;
            }

            fileInput.files = e.dataTransfer.files;
            // è§¦å‘æ–‡ä»¶å˜æ›´äº‹ä»¶
            fileInput.onchange({ target: { files: [file] } });
        };
    </script>
</body>

</html>